<!DOCTYPE html>
<html>

<head>
  
  


<script async src="https://www.googletagmanager.com/gtag/js?id=G-1N1QDGEHGN"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-1N1QDGEHGN');
</script>



<meta charset="utf-8" />
<meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css?family=Galindo" rel="stylesheet">

<title>go - GakuBlog</title>

<link rel="alternate" type="application/rss&#43;xml" href="https://blog.zitaku.net/tags/go/index.xml" title="$.Site.Title" />

<link rel="stylesheet" href="/scss/site.css" integrity="" media="screen">

</head>

<body>
  <header class='header'>
  <h1><a href='/'>GakuBlog</a></h1>
  <ul class='service-icons'>
  <li class='service-icon'><a target="_blank" class='twitter' href='https://twitter.com/Gaku07jp'><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 480" height="480" width="480"><path transform="matrix(1.25,0,0,-1.25,0,480)" d="m 319.23265,257.24794 c 0.1216,-2.81531 0.1984,-5.64341 0.1984,-8.49071 C 319.43105,162.02018 253.39077,62 132.63799,62 95.563528,62 61.055418,72.87732 31.999999,91.496739 c 5.132697,-0.601454 10.361393,-0.921371 15.660487,-0.921371 30.757785,0 59.064424,10.493412 81.534374,28.101882 -28.73543,0.52467 -52.971745,19.5088 -61.329978,45.58877 4.01272,-0.7742 8.121438,-1.1837 12.358153,-1.1837 5.98388,0 11.788564,0.8062 17.292454,2.30343 -30.034599,6.02732 -52.664547,32.55519 -52.664547,64.35536 0,0.28153 0,0.55026 0.0064,0.8254 8.851023,-4.90759 18.975621,-7.86366 29.733806,-8.20919 -17.612448,11.77311 -29.202617,31.85777 -29.202617,54.63616 0,12.02264 3.238336,23.30306 8.889423,32.99668 32.383352,-39.71502 80.753586,-65.83979 135.318896,-68.58472 -1.11998,4.80522 -1.69597,9.82159 -1.69597,14.95951 0,36.24709 29.38821,65.63505 65.64989,65.63505 18.88602,0 35.94808,-7.96604 47.92224,-20.72449 14.9501,2.94327 28.99782,8.40113 41.68237,15.92568 -4.89591,-15.33064 -15.3085,-28.18507 -28.86343,-36.31107 13.27334,1.58681 25.93228,5.11234 37.70805,10.33346 -8.81262,-13.16796 -19.9356,-24.72992 -32.76095,-33.97564 z"/></svg>
</a></li>
  <li class='service-icon'><a target="_blank" class='github' href='https://github.com/ManabuSeki'><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 480" height="480" width="480"><path transform="matrix(1.25,0,0,-1.25,0,480)" d="m 336,240.61116 c 0,22.71565 -8.13329,41.27381 -21.57259,55.84104 2.17534,5.2465 9.35329,26.39909 -2.05915,55.06591 0,0 -17.57695,5.59243 -57.59793,-21.32555 -16.75717,4.61232 -34.70851,6.92488 -52.5243,7.00816 -17.81579,-0.0833 -35.74778,-2.38944 -52.47268,-7.00816 -40.05971,26.91798 -57.662482,21.32555 -57.662482,21.32555 C 80.730709,322.8577 87.90221,301.6987 90.077543,296.4522 76.66406,281.87856 68.47267,263.3204 68.47267,240.61116 c 0,-79.72258 48.9547,-97.56327 95.52104,-102.82259 -5.99669,-5.19526 -11.4318,-14.37505 -13.3102,-27.82123 -11.96756,-5.31698 -42.31251,-14.509569 -61.012631,17.29618 0,0 -11.083229,19.98029 -32.139428,21.44726 0,0 -20.455885,0.26906 -1.43301,-12.65183 0,0 13.742688,-6.39318 23.276718,-30.44128 0,0 12.303224,-37.135539 70.630581,-24.547759 0.0904,-17.38587 0.28401,-44.11808 0.28401,-49.06991 l 103.95127,0 c 0,6.85441 0.24529,39.59544 0.24529,67.43589 0,19.410149 -6.70028,32.068399 -14.22036,38.532039 C 286.95494,143.11835 336,160.71561 336,240.62397 Z M 72.003554,139.07617 c -0.458306,-1.03777 -2.097875,-1.34526 -3.58898,-0.63419 -1.523378,0.67903 -2.368983,2.08835 -1.884858,3.12612 0.45185,1.0634 2.091419,1.35807 3.614799,0.65341 1.516923,-0.67903 2.388348,-2.10757 1.859039,-3.13893 z m 8.494775,-9.404 c -1.000525,-0.92246 -2.956389,-0.49326 -4.279663,0.9609 -1.374915,1.45416 -1.626659,3.38877 -0.613224,4.32405 1.032798,0.92246 2.930567,0.48685 4.299027,-0.9609 1.374914,-1.46697 1.639569,-3.38877 0.59386,-4.32405 z m 8.262396,-11.9728 c -1.284545,-0.88402 -3.388873,-0.056 -4.686328,1.79368 -1.284544,1.85133 -1.284544,4.06781 0.02582,4.95824 1.297455,0.88403 3.369508,0.0833 4.686328,-1.74884 1.284543,-1.88336 1.284543,-4.09983 -0.02582,-5.00308 z m 11.328515,-11.58203 c -1.148985,-1.25558 -3.601885,-0.92247 -5.389919,0.80075 -1.833219,1.67837 -2.343163,4.05499 -1.194174,5.31697 1.168354,1.25557 3.627709,0.90965 5.435108,-0.80075 1.820305,-1.67837 2.368985,-4.0678 1.148985,-5.31697 z m 15.6211,-6.726299 c -0.50995,-1.62712 -2.86602,-2.37021 -5.24146,-1.67837 -2.36899,0.71748 -3.92464,2.620059 -3.44051,4.266399 0.49058,1.63993 2.86601,2.41506 5.24791,1.67196 2.36898,-0.71107 3.92464,-2.60083 3.4276,-4.259989 z m 12.70988,-4.40732 c -2.50453,-0.056 -4.53786,1.33245 -4.56368,3.01722 0,1.73603 1.96878,3.138939 4.47977,3.183779 2.49163,0.0481 4.53786,-1.332439 4.53786,-3.036439 0.0516,-1.7104 -1.96232,-3.13893 -4.45395,-3.16456 z m 16.50543,2.01148 c -2.43353,-0.44201 -4.68632,0.58935 -4.99617,2.25491 -0.29692,1.716809 1.46529,3.440019 3.89237,3.882029 2.47872,0.42921 4.69924,-0.57653 5.01553,-2.28053 0.29693,-1.671959 -1.43946,-3.388769 -3.91173,-3.849999 z"/></svg>
</a></li>
</ul>

</header>


  <div class='main-container'>
    <div class='articles'>
      
<div class='summaries'>
  <h1>&ldquo;go&rdquo; タグのついた記事</h1>
  <ul class='summary-items'>
    
    <li class='summary-item'>
      <p class='date'>
        <time datetime=" 2022-12-10T00:00:00&#43;09:00">2022-12-10</time>
      </p>
      <h2 class='title'><a href="/2022/12/11/">X-Accel-RedirectとgoでS3ファイルに認証をつけて配信する方法</a></h2>
      <p class='body'><p>この記事は <a href="https://qiita.com/advent-calendar/2022/fuller-inc" target="_blank">フラー株式会社 Advent Calendar 2022</a>
 11日目の記事です。<br>
10日目は <a href="https://qiita.com/nnsnodnb" target="_blank">@nnsnodnb</a>
 さんで <a href="https://nnsnodnb.hatenablog.jp/entry/circleci-orbs-firebase-app-distribution" target="_blank">Firebase App Distribution で配信するための CircleCI Orb を自作した</a>
 でした。</p>
<h2 id="はじめに">はじめに</h2>
<p>早いもので前回のブログから1年経ってしまいました。(去年も同じこと言ってる)<br>
毎年のことながらブログを書く前にhugoのアップデートとCIのアップデートにばかり時間を使ってしまいました。<br>
来年はこれだけで記事がかけるかもしれない</p>
<p>さて、今回もとある案件でのお話です。<br>
今回は静的コンテンツを特定の認証されたユーザーのみに配信するという要件がありました。(よくありますね！)<br>
かんたんにPrivateなS3バケットのコンテンツを安全に配信できる方法ないかな〜とぼんやり考えていた時にあることを思い出しました。それは2021年のISUCON予選の振り返り会をしている時に、@sora_hさんが「実は認証のみアプリケーションで行い画像の配信はnginxで行えたんですよ〜」という話をしていて「そんなことできるのか！すげぇ〜」と感動したことがあったのです。<br>
当時はDBにバイナリーで格納されている画像ファイルをエクスポートしてnginxで配布することでDBサーバーへの負荷軽減につながるという話だったのですが、まさかこんな形で業務で使うことになるとはISUCON様様です。</p>
<p>今回はマネーフォワードさんのテックブログ<a href="https://qiita.com/advent-calendar/2022/fuller-inc" target="_blank">S3のファイルをX-Accel-Redirectで配信する</a>
を参考にgoで実装してみます</p></p>
    </li>
    
  </ul>
  <div class='pager'>
    <span class='pager-link'></span>
    <span class='pager-status'>Page 1 of 1</span>
    <span class='pager-link'></span>
  </div>
</div>

    </div>

    <div class='asides'>
  <aside class='aside'>
    <h2>Author</h2>
    <div style='text-align:center'>
      <img class='profile_img' alt='筆者のプロフィール写真' src='/images/profile.png'>
    </div>
    <h3>Manabu Seki (@Gaku07jp)</h3>
    <p>
      フラー株式会社<br>
      サーバーサイドエンジニア
    </p>
  </aside>

  <aside class='aside'>
    <h2>Recent Articles</h2>
    <ol class='recent-articles'>
      
      <li class='recent-article'>
        <p class='recent-article-date'>
          <time datetime="2022-12-10T00:00:00&#43;09:00">2022-12-10</time>
        </p>
        <p class='recent-article-title'><a href="/2022/12/11/">X-Accel-RedirectとgoでS3ファイルに認証をつけて配信する方法</a></p>
      </li>
      
      <li class='recent-article'>
        <p class='recent-article-date'>
          <time datetime="2021-12-22T00:00:00&#43;09:00">2021-12-22</time>
        </p>
        <p class='recent-article-title'><a href="/2021/12/22/">CloudFormationのパラメータ管理をjsonにした話</a></p>
      </li>
      
      <li class='recent-article'>
        <p class='recent-article-date'>
          <time datetime="2020-12-05T00:00:00&#43;09:00">2020-12-05</time>
        </p>
        <p class='recent-article-title'><a href="/2020/12/12/">自動レビュー依頼のactionを作成しました</a></p>
      </li>
      
      <li class='recent-article'>
        <p class='recent-article-date'>
          <time datetime="2019-12-13T00:00:00&#43;09:00">2019-12-13</time>
        </p>
        <p class='recent-article-title'><a href="/2019/12/13/">Blogをhugoに移行しました</a></p>
      </li>
      
    </ol>
  </aside>

  <aside class='aside'>
    <h2>Tags</h2>
    <ol class='category-items'>
      
      
      <li class='articles-item'>
        <a href="/tags/aws/"> aws <small>(2)</small></a>
      </li>
      
      
      <li class='articles-item'>
        <a href="/tags/ci/"> ci <small>(1)</small></a>
      </li>
      
      
      <li class='articles-item'>
        <a href="/tags/github/"> github <small>(1)</small></a>
      </li>
      
      
      <li class='articles-item'>
        <a href="/tags/go/"> go <small>(1)</small></a>
      </li>
      
      
      <li class='articles-item'>
        <a href="/tags/hugo/"> hugo <small>(1)</small></a>
      </li>
      
      
      <li class='articles-item'>
        <a href="/tags/nginx/"> nginx <small>(1)</small></a>
      </li>
      
    </ol>
  </aside>

  <aside class='aside'>
    <h2>By Year</h2>
    <ol class='category-items'>
      
      <li class='articles-item'><a href="/2022/">2022 <small>(1)</small></a></li>
      
      <li class='articles-item'><a href="/2021/">2021 <small>(1)</small></a></li>
      
      <li class='articles-item'><a href="/2020/">2020 <small>(1)</small></a></li>
      
      <li class='articles-item'><a href="/2019/">2019 <small>(1)</small></a></li>
      
    </ol>
  </aside>
</div>

  </div>

  <footer class='footer'>
  <ul class='service-icons'>
  <li class='service-icon'><a target="_blank" class='twitter' href='https://twitter.com/Gaku07jp'><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 480" height="480" width="480"><path transform="matrix(1.25,0,0,-1.25,0,480)" d="m 319.23265,257.24794 c 0.1216,-2.81531 0.1984,-5.64341 0.1984,-8.49071 C 319.43105,162.02018 253.39077,62 132.63799,62 95.563528,62 61.055418,72.87732 31.999999,91.496739 c 5.132697,-0.601454 10.361393,-0.921371 15.660487,-0.921371 30.757785,0 59.064424,10.493412 81.534374,28.101882 -28.73543,0.52467 -52.971745,19.5088 -61.329978,45.58877 4.01272,-0.7742 8.121438,-1.1837 12.358153,-1.1837 5.98388,0 11.788564,0.8062 17.292454,2.30343 -30.034599,6.02732 -52.664547,32.55519 -52.664547,64.35536 0,0.28153 0,0.55026 0.0064,0.8254 8.851023,-4.90759 18.975621,-7.86366 29.733806,-8.20919 -17.612448,11.77311 -29.202617,31.85777 -29.202617,54.63616 0,12.02264 3.238336,23.30306 8.889423,32.99668 32.383352,-39.71502 80.753586,-65.83979 135.318896,-68.58472 -1.11998,4.80522 -1.69597,9.82159 -1.69597,14.95951 0,36.24709 29.38821,65.63505 65.64989,65.63505 18.88602,0 35.94808,-7.96604 47.92224,-20.72449 14.9501,2.94327 28.99782,8.40113 41.68237,15.92568 -4.89591,-15.33064 -15.3085,-28.18507 -28.86343,-36.31107 13.27334,1.58681 25.93228,5.11234 37.70805,10.33346 -8.81262,-13.16796 -19.9356,-24.72992 -32.76095,-33.97564 z"/></svg>
</a></li>
  <li class='service-icon'><a target="_blank" class='github' href='https://github.com/ManabuSeki'><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 480" height="480" width="480"><path transform="matrix(1.25,0,0,-1.25,0,480)" d="m 336,240.61116 c 0,22.71565 -8.13329,41.27381 -21.57259,55.84104 2.17534,5.2465 9.35329,26.39909 -2.05915,55.06591 0,0 -17.57695,5.59243 -57.59793,-21.32555 -16.75717,4.61232 -34.70851,6.92488 -52.5243,7.00816 -17.81579,-0.0833 -35.74778,-2.38944 -52.47268,-7.00816 -40.05971,26.91798 -57.662482,21.32555 -57.662482,21.32555 C 80.730709,322.8577 87.90221,301.6987 90.077543,296.4522 76.66406,281.87856 68.47267,263.3204 68.47267,240.61116 c 0,-79.72258 48.9547,-97.56327 95.52104,-102.82259 -5.99669,-5.19526 -11.4318,-14.37505 -13.3102,-27.82123 -11.96756,-5.31698 -42.31251,-14.509569 -61.012631,17.29618 0,0 -11.083229,19.98029 -32.139428,21.44726 0,0 -20.455885,0.26906 -1.43301,-12.65183 0,0 13.742688,-6.39318 23.276718,-30.44128 0,0 12.303224,-37.135539 70.630581,-24.547759 0.0904,-17.38587 0.28401,-44.11808 0.28401,-49.06991 l 103.95127,0 c 0,6.85441 0.24529,39.59544 0.24529,67.43589 0,19.410149 -6.70028,32.068399 -14.22036,38.532039 C 286.95494,143.11835 336,160.71561 336,240.62397 Z M 72.003554,139.07617 c -0.458306,-1.03777 -2.097875,-1.34526 -3.58898,-0.63419 -1.523378,0.67903 -2.368983,2.08835 -1.884858,3.12612 0.45185,1.0634 2.091419,1.35807 3.614799,0.65341 1.516923,-0.67903 2.388348,-2.10757 1.859039,-3.13893 z m 8.494775,-9.404 c -1.000525,-0.92246 -2.956389,-0.49326 -4.279663,0.9609 -1.374915,1.45416 -1.626659,3.38877 -0.613224,4.32405 1.032798,0.92246 2.930567,0.48685 4.299027,-0.9609 1.374914,-1.46697 1.639569,-3.38877 0.59386,-4.32405 z m 8.262396,-11.9728 c -1.284545,-0.88402 -3.388873,-0.056 -4.686328,1.79368 -1.284544,1.85133 -1.284544,4.06781 0.02582,4.95824 1.297455,0.88403 3.369508,0.0833 4.686328,-1.74884 1.284543,-1.88336 1.284543,-4.09983 -0.02582,-5.00308 z m 11.328515,-11.58203 c -1.148985,-1.25558 -3.601885,-0.92247 -5.389919,0.80075 -1.833219,1.67837 -2.343163,4.05499 -1.194174,5.31697 1.168354,1.25557 3.627709,0.90965 5.435108,-0.80075 1.820305,-1.67837 2.368985,-4.0678 1.148985,-5.31697 z m 15.6211,-6.726299 c -0.50995,-1.62712 -2.86602,-2.37021 -5.24146,-1.67837 -2.36899,0.71748 -3.92464,2.620059 -3.44051,4.266399 0.49058,1.63993 2.86601,2.41506 5.24791,1.67196 2.36898,-0.71107 3.92464,-2.60083 3.4276,-4.259989 z m 12.70988,-4.40732 c -2.50453,-0.056 -4.53786,1.33245 -4.56368,3.01722 0,1.73603 1.96878,3.138939 4.47977,3.183779 2.49163,0.0481 4.53786,-1.332439 4.53786,-3.036439 0.0516,-1.7104 -1.96232,-3.13893 -4.45395,-3.16456 z m 16.50543,2.01148 c -2.43353,-0.44201 -4.68632,0.58935 -4.99617,2.25491 -0.29692,1.716809 1.46529,3.440019 3.89237,3.882029 2.47872,0.42921 4.69924,-0.57653 5.01553,-2.28053 0.29693,-1.671959 -1.43946,-3.388769 -3.91173,-3.849999 z"/></svg>
</a></li>
</ul>

</footer>

</body>

</html>
